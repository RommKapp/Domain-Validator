# Product Requirements Document: Email Domain Validation Service

## 1. Обзор проекта

### 1.1 Название продукта
Email Domain Validator (EDV) - внутренний сервис классификации и проверки email доменов

### 1.2 Краткое описание
Сервис для автоматической проверки и классификации email доменов с целью фильтрации входящих контактов, определения их качества и типа. Система позволяет отделить корпоративные домены от публичных email-провайдеров и временных email-сервисов.

### 1.3 Ключевые стейкхолдеры
- Команда продаж (основные пользователи)
- Команда маркетинга
- Команда разработки
- Команда информационной безопасности

## 2. Цели и задачи

### 2.1 Бизнес-цели
- Повышение качества лидов на 40% путем фильтрации временных и нерелевантных email адресов
- Снижение времени на обработку некачественных контактов на 60%
- Улучшение email deliverability за счет исключения невалидных доменов
- Создание базы знаний о качестве доменов для всей компании

### 2.2 Технические задачи
- Автоматическая классификация доменов по категориям
- Проверка существования и доступности доменов
- Поддержание актуальной базы данных доменов
- Интеграция с существующими системами CRM и маркетинговыми платформами

## 3. Классификация доменов

### 3.1 Типы доменов

#### Тип 1: Корпоративные домены (Corporate)
- **Описание**: Домены, принадлежащие реальным компаниям
- **Примеры**: company.com, enterprise.io
- **Характеристики**:
  - Имеют работающий веб-сайт
  - Зарегистрированы на юридическое лицо
  - Имеют корпоративные MX-записи
  - Не входят в списки публичных провайдеров

#### Тип 2: Публичные email-провайдеры (Public Providers)
- **Описание**: Крупные email-сервисы для физических лиц
- **Примеры**: gmail.com, yahoo.com, outlook.com, mail.ru
- **Характеристики**:
  - Массовые бесплатные сервисы
  - Высокий трафик
  - Известные MX-серверы

#### Тип 3: Временные email-сервисы (Disposable)
- **Описание**: Сервисы для создания временных email адресов
- **Примеры**: tempmail.com, guerrillamail.com
- **Характеристики**:
  - Короткий срок жизни адресов
  - Анонимность
  - Входят в blacklist базы

#### Тип 4: Образовательные домены (Educational)
- **Описание**: Домены учебных заведений
- **Примеры**: harvard.edu, mit.edu
- **Характеристики**:
  - Домены .edu или национальные образовательные
  - Официальные учебные заведения

#### Тип 5: Правительственные домены (Government)
- **Описание**: Домены государственных организаций
- **Примеры**: whitehouse.gov, kremlin.ru
- **Характеристики**:
  - Домены .gov или национальные правительственные
  - Официальные государственные организации

#### Тип 6: Недоступные домены (Unreachable)
- **Описание**: Домены без работающего сайта или email
- **Характеристики**:
  - Нет DNS записей
  - Нет MX записей
  - Сайт не отвечает

#### Тип 7: Подозрительные домены (Suspicious)
- **Описание**: Домены с признаками мошенничества
- **Характеристики**:
  - Новая регистрация (< 30 дней)
  - Похожи на известные бренды (typosquatting)
  - Множество перенаправлений

## 4. Функциональные требования

### 4.1 Основные функции

#### F1: Проверка домена
- Входные данные: email адрес или домен
- Выходные данные: 
  - Тип домена
  - Статус доступности
  - Оценка качества (1-10)
  - Метаданные (дата регистрации, регистратор, страна)
  - Рекомендация (принимать/отклонять/проверить вручную)

#### F2: Массовая проверка
- Загрузка CSV/Excel файлов с email адресами
- Асинхронная обработка больших объемов
- Экспорт результатов с классификацией

#### F3: API для интеграций
- REST API для проверки единичных доменов
- Webhook для автоматических проверок
- Batch API для массовых проверок

#### F4: Управление базой данных доменов
- Добавление доменов в whitelist/blacklist
- Изменение классификации доменов
- Добавление комментариев и тегов
- История изменений

#### F5: Аналитика и отчеты
- Статистика по типам доменов
- Тренды качества входящих контактов
- Отчеты по заблокированным доменам
- ROI от фильтрации

### 4.2 Алгоритм классификации

```
1. Проверка в локальном кеше
2. Если не найден:
   a. Проверка в disposable списках
   b. Проверка в списке email-провайдеров
   c. DNS проверки:
      - Существование домена
      - MX записи
      - A/AAAA записи
   d. HTTP(S) проверка доступности сайта
   e. WHOIS проверка (опционально)
   f. Проверка SSL сертификата
3. Scoring и классификация
4. Сохранение в кеш
```

## 5. Технические требования

### 5.1 Архитектура

#### Компоненты системы:
1. **API Gateway** - точка входа для всех запросов
2. **Validation Engine** - ядро классификации
3. **Cache Layer** (Redis) - кеширование результатов
4. **Database** (PostgreSQL) - хранение доменов и метаданных
5. **Queue System** (RabbitMQ/Kafka) - обработка массовых проверок
6. **External Services Connector** - интеграция с внешними API
7. **Admin Panel** - управление системой

### 5.2 Источники данных

#### Disposable email списки:
- https://github.com/disposable-email-domains/disposable-email-domains/
- https://github.com/FGRibreau/mailchecker
- https://github.com/wesbos/burner-email-providers
- https://github.com/7c/fakefilter
- HubSpot blocked domains list

#### Дополнительные источники:
- DNS серверы для проверки записей
- WHOIS серверы для информации о регистрации
- VirusTotal API для проверки репутации
- SSL Labs API для проверки сертификатов

### 5.3 Технологический стек
- **Backend**: Python/Go для высокой производительности
- **API**: FastAPI/Gin
- **База данных**: PostgreSQL + Redis
- **Очереди**: RabbitMQ/Kafka
- **Мониторинг**: Prometheus + Grafana
- **Логирование**: ELK Stack

## 6. Нефункциональные требования

### 6.1 Производительность
- Проверка единичного домена: < 500ms
- Массовая проверка: 1000 доменов/минута
- Uptime: 99.9%

### 6.2 Масштабируемость
- Горизонтальное масштабирование validation engine
- Поддержка до 10M проверок в день

### 6.3 Безопасность
- API ключи для аутентификации
- Rate limiting
- Логирование всех операций
- GDPR compliance

## 7. Интеграции

### 7.1 CRM системы
- Salesforce
- HubSpot
- Pipedrive
- Пользовательские CRM через API

### 7.2 Маркетинговые платформы
- Mailchimp
- SendGrid
- ActiveCampaign

### 7.3 Внутренние системы
- SSO для аутентификации
- Корпоративная шина данных
- Системы аналитики

## 8. Пользовательский интерфейс

### 8.1 Web интерфейс
- Dashboard с ключевыми метриками
- Форма единичной проверки
- Интерфейс массовой загрузки
- Управление правилами и списками
- Отчеты и аналитика

### 8.2 API документация
- Swagger/OpenAPI спецификация
- Примеры интеграции
- SDK для популярных языков

## 9. Процесс обновления данных

### 9.1 Автоматические обновления
- Ежедневная синхронизация с GitHub репозиториями
- Мержинг списков методом голосования (2+ вхождения)
- Проверка изменений в DNS записях кешированных доменов

### 9.2 Ручные обновления
- Интерфейс для добавления доменов
- Процесс review для спорных доменов
- Возможность override автоматической классификации

## 10. Метрики успеха

### 10.1 Технические метрики
- Точность классификации: > 95%
- Скорость ответа API: p95 < 500ms
- Доступность сервиса: > 99.9%

### 10.2 Бизнес-метрики
- Снижение bounce rate email кампаний на 30%
- Увеличение конверсии лидов на 25%
- Экономия времени sales team: 5 часов/неделю

## 11. План реализации

### Фаза 1: MVP (4 недели)
- Базовый API для проверки доменов
- Интеграция disposable списков
- Простой web интерфейс
- Кеширование результатов

### Фаза 2: Расширение функционала (6 недель)
- Массовая проверка
- DNS и HTTP проверки
- Управление whitelist/blacklist
- API для интеграций

### Фаза 3: Аналитика и оптимизация (4 недели)
- Dashboard с метриками
- Отчеты и экспорт
- Machine learning для улучшения классификации
- Оптимизация производительности

### Фаза 4: Интеграции (6 недель)
- Интеграция с CRM
- Webhooks и real-time проверки
- SDK и документация

## 12. Риски и митигация

### 12.1 Технические риски
- **Риск**: Изменение структуры внешних списков
- **Митигация**: Версионирование парсеров, мониторинг источников

- **Риск**: DDoS на публичный API
- **Митигация**: Rate limiting, CDN, автомасштабирование

### 12.2 Бизнес-риски
- **Риск**: Ложные срабатывания для легитимных доменов
- **Митигация**: Whitelist, ручная проверка, feedback loop

## 13. Будущие улучшения

- Machine Learning модель для предсказания качества домена
- Интеграция с threat intelligence платформами
- Проверка репутации IP адресов mail серверов
- Анализ паттернов регистрации доменов
- API для публичного использования (монетизация)